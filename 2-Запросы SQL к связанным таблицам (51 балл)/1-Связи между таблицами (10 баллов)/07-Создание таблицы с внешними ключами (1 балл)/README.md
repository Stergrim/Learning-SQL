# Создание таблицы с внешними ключами

При создании зависимой таблицы (таблицы, которая содержит внешние ключи) необходимо учитывать, что :
- каждый внешний ключ должен иметь такой же тип данных, как связанное поле главной таблицы (в наших примерах это `INT`);
- необходимо указать главную для нее таблицу и столбец, по которому осуществляется связь:

```mysql
FOREIGN KEY (связанное_поле_зависимой_таблицы)  
REFERENCES главная_таблица (связанное_поле_главной_таблицы)
```

По умолчанию любой столбец, кроме ключевого, может содержать значение `NULL`. При создании таблицы это можно переопределить,  используя  ограничение `NOT NULL` для этого столбца:

```mysql
CREATE TABLE таблица (
    столбец_1 INT NOT NULL, 
    столбец_2 VARCHAR(10) 
);
```

В созданной таблице в `столбец_1` не может содержать пустое значение, а `столбец_2` - может.

Для внешних ключей рекомендуется устанавливать ограничение `NOT NULL` (если это совместимо с другими опциями, которые будут рассмотрены в следующем шаге).

**Пример**

Создать таблицу `book` следующей структуры:

| **Поле**    | **Тип, описание**                | **Связи**                                                                                                    |
|:------------|:---------------------------------|:-------------------------------------------------------------------------------------------------------------|
| `book_id`   | `INT PRIMARY KEY AUTO_INCREMENT` |                                                                                                              |
| `title`     | `VARCHAR(50)`                    |                                                                                                              |
| `author_id` | `INT`                            | внешний ключ: главная таблица `author`, связанный столбец `author.author_id`, пустое значение не допускается |
| `price`     | `DECIMAL(8, 2)`                  |                                                                                                              |
| `amount`    | `INT`                            |                                                                                                              |

*Запрос:*

```mysql
CREATE TABLE book (
    book_id INT PRIMARY KEY AUTO_INCREMENT, 
    title VARCHAR(50), 
    author_id INT NOT NULL, 
    price DECIMAL(8,2), 
    amount INT, 
    FOREIGN KEY (author_id)  REFERENCES author (author_id) 
);
```

**Задание**

Перепишите запрос на создание таблицы `book`, чтобы ее структура соответствовала структуре, показанной на логической схеме (таблица `genre` уже создана, порядок следования столбцов - как на логической схеме в таблице `book`, `genre_id`  - внешний ключ). Для `genre_id` ограничение о недопустимости пустых значений **не задавать**. В качестве главной таблицы для описания поля  `genre_id` использовать таблицу `genre` следующей структуры:

| **Поле**     | **Тип, описание**                |
|:-------------|:---------------------------------|
| `genre_id`   | `INT PRIMARY KEY AUTO_INCREMENT` |
| `name_genre` | `VARCHAR(50)`                    |

Логическая схема (нужно создать только таблицу `book`):

<p float="left">
<img src="cx1.jpg" width="400" />
</p>

Введите SQL запрос

*Результат:*

```mysql
Affected rows: 0
```

```mysql
CREATE TABLE book (book_id INT PRIMARY KEY AUTO_INCREMENT, 
                   title VARCHAR(50), 
                   author_id INT NOT NULL,
                   genre_id INT,
                   price DECIMAL(8,2), 
                   amount INT, 
                   FOREIGN KEY (author_id)  REFERENCES author (author_id),
                   FOREIGN KEY (genre_id)  REFERENCES genre (genre_id));
```

Вы получили: 1 балл из 1
